{% extends "base.html" %}

{% block title %}M√¶labor√∞{% endblock %}

{% block content %}
<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
    {% set task_names = {
        'sentiment': 'Lyndisgreining',
        'toxicity': 'Eitru√∞ umm√¶li',
        'politeness': 'Kurteisi',
        'hate_speech_presence': 'Hatursor√∞r√¶√∞a',
        'social_acceptability_strangers': 'F√©lagslegt sam√æykki (√≥kunnugir)',
        'social_acceptability_acquaintances': 'F√©lagslegt sam√æykki (kunningjar)',
        'social_acceptability_close_friend': 'F√©lagslegt sam√æykki (n√°inn vinur)',
        'social_acceptability_educational_young': 'F√©lagslegt sam√æykki (1.-3. bekkur)',
        'social_acceptability_educational_older': 'F√©lagslegt sam√æykki (8.-10. bekkur)',
        'social_acceptability_parliament': 'F√©lagslegt sam√æykki (√≠ √æingr√¶√∞u)',
        'emotion_anger': 'Tilfinning: Rei√∞i',
        'emotion_joy': 'Tilfinning: Gle√∞i',
        'emotion_sadness': 'Tilfinning: Sorg',
        'emotion_fear': 'Tilfinning: √ìtti',
        'emotion_disgust': 'Tilfinning: Vi√∞bj√≥√∞ur',
        'emotion_surprise': 'Tilfinning: Undrun',
        'emotion_contempt': 'Tilfinning: Fyrirlitning',
        'emotion_indignation': 'Tilfinning: Hneykslun',
        'sarcasm': 'Kaldh√¶√∞ni',
        'constructiveness': 'Uppbyggileg or√∞r√¶√∞a',
        'encouragement_presence': 'Hvatning',
        'sympathy': 'Sam√∫√∞',
        'trolling_behavior': 'Nettr√∂ll',
        'mansplaining': 'Hr√∫tsk√Ωringar',
        'group_generalization_presence': 'Alh√¶fingar um h√≥pa'
    } %}

    {% for task, progress in user_progress.items() %}
        <div class="card bg-base-100 shadow-xl">
            <div class="card-body">
                <h2 class="card-title text-lg">{{ task_names[task] }}</h2>
                <p class="text-2xl font-bold mb-2">{{ progress.user_without_skip }} {{ 'merking' if progress.user_without_skip % 10 == 1 else 'merkingar' }}</p>
                <div class="flex items-center space-x-2">
                    {% if progress.user_without_skip >= 10 %}
                        <span class="text-3xl" title="Bronsver√∞laun: 10+ merkingar">ü•â</span>
                    {% endif %}
                    {% if progress.user_without_skip >= 50 %}
                        <span class="text-3xl" title="Silfurver√∞laun: 50+ merkingar">ü•à</span>
                    {% endif %}
                    {% if progress.user_without_skip >= 100 %}
                        <span class="text-3xl" title="Gullver√∞laun: 100+ merkingar">üèÜ</span>
                    {% endif %}
                    {% if progress.user_without_skip >= 250 %}
                        <span class="text-3xl" title="Regnbogaver√∞laun: 250+ merkingar">üåü</span>
                    {% endif %}
                    {% if progress.user_without_skip >= 500 %}
                        <span class="text-3xl" title="Regnbogaver√∞laun: 500+ merkingar">üåà</span>
                    {% endif %}
                    {% if progress.user_without_skip >= 1000 %}
                        <span class="text-3xl" title="Regnbogaver√∞laun: 1000+ merkingar">ü¶Ñ</span>
                    {% endif %}
                </div>
                {% if current_user.feedback_enabled and progress.user_without_skip > 0 %}
                    <p class="text-sm mt-2">Samm√°la gervigreind √≠ {{ progress.agreement_ratio|default('√Å ekki vi√∞') }}% tilvika</p>
                {% endif %}
                <div class="card-actions justify-end mt-4">
                    <a href="{{ url_for('annotate', task=task) }}" class="btn btn-primary btn-sm">Merkja</a>
                </div>
            </div>
        </div>
    {% endfor %}
</div>

<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <h2 class="card-title">Heildarframvinda</h2>
            <div class="h-64 overflow-y-auto pr-2">
                {% for task, progress in user_progress.items() %}
                    <div class="mt-2">
                        <p class="text-sm font-bold">{{ task_names[task] }}</p>
                        <progress class="progress progress-secondary w-full" value="{{ progress.total }}" max="5000"></progress>
                        <div class="flex justify-between text-xs">
                            <span>Heildarfj√∂ldi merkinga: {{ progress.total }}/5000</span>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <h2 class="card-title">Stigatafla</h2>
            <div class="h-64 overflow-y-auto pr-2">
                <table class="table w-full">
                    <thead>
                        <tr>
                            <th>S√¶ti</th>
                            <th>Notandi</th>
                            <th>Heildarfj√∂ldi merkinga</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for user in leaderboard %}
                            <tr>
                                <td>{{ loop.index }}</td>
                                <td>{{ user.display_name }}</td>
                                <td>{{ user.total_annotations }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}